# Database Management System

Система управления базами данных, написанная на C++.

## Структура проекта

`db` - место, где БД хранит таблицы  
`out` - исполняемые файлы  
`src` - исходный код  
`src/engine` - модуль движка БД  
`src/query_parser` - модуль парсинга запросов  
`src/query_processor` - модуль исполнения запросов  
`src/socket` - ООП-обертка сокетов
`src/shared` - вспомогательные функции для работы со std::string/std::vector/std::set  

## Синтаксис языка

### SQL запрос

- <SQL-запрос> ::= <SELECT-запрос> | <INSERT-запрос> | <UPDATE-запрос> | <DELETE-запрос> | <CREATE-запрос> | <DROP-запрос>  

### Виды запросов

- <SELECT-запрос> ::= SELECT <список полей> FROM <имя таблицы> [<WHERE-клауза>]  
- <INSERT-запрос> ::= INSERT INTO <имя таблицы> (<значение поля> { , <значение поля> })  
- <UPDATE-запрос> ::= UPDATE <имя таблицы> SET <имя поля> = <выражение> [<WHERE-клауза>]  
- <DELETE-запрос> ::= DELETE FROM <имя таблицы> <WHERE-клауза>  
- <CREATE-запрос> ::= CREATE TABLE <имя таблицы> ( <список описаний полей> )  
- <DROP-запрос> ::= DROP TABLE <имя таблицы>  

### WHERE клауза

- <WHERE-клауза> ::= WHERE (<логическое выражение> | ALL)  
- <логическое выражение> ::= <логическое слагаемое> { OR <логическое слагаемое> }  
- <логическое слагаемое> ::= <логический множитель> { AND <логический множитель> }  
- <логический множитель> ::= ( NOT <логический множитель> ) | ((<логическое выражение>)) | <операция>  
- <операция> ::= <отношение> | <like-выражение> | <in-выражение>  
- <like-выражение> ::= <имя поля> [ NOT ] LIKE <строка>  
- <in-выражение> ::= <выражение> [ NOT ] IN ( <список констант> )  
- <отношение> ::= <string-отношение> | <number-отношение>  
- <string-отношение> ::= <string-выражение> <операция сравнения> <string-выражение>  
- <number-отношение> ::= <number-выражение> <операция сравнения> <number-выражение>  
- <операция сравнения> ::= = | > | < | >= | <= | !=  

### Общие определения

- <список полей> ::= <имя поля> { , <имя поля> } | *  
- <имя таблицы> ::= <имя>  
- <имя поля> ::= <имя>  
- <значение поля> ::= <строка> | <число>  
- <имя> ::= <имя> [ <буква> | <цифра> | _ ] | <буква>  
- <значение поля> ::= <строка> | <число>  
- <строка> ::= '<символ> { <символ> }'  
- <символ> ::= <любой символ клавиатуры кроме '>  
- <список описаний полей> ::= <описание поля> { , <описание поля> }  
- <описание поля> ::= <имя поля> <тип поля>  
- <тип поля> ::= VARCHAR ( <целое без знака> ) | NUMBER  
- <выражение> ::= <string-выражение> | <number-выражение>  
- <string-выражение> ::= <имя поля> | <строка>  
- <number-выражение> ::= <имя поля> | <число>  
- <число> ::= <цифра кроме нуля><последовательность цифр>[ .[ <последовательность цифр> ] <цифра кроме нуля> ]  
- <последовательность цифр> ::= <цифра> [ <последовательность цифр> ]  

## Модуль 1 - ООП-обертка сокетов

- BaseSocket - абстрактный базовый класс  
- ServerSocket - управялющий сокет сервера, осуществляющий подключение клиентов  
- ClientSocket - клиентский сокет, осуществляющий обмен сообщениями  
- SocketException - ислкючение, возникающее при некорректной работе сокетов  

## Модуль 2 - Движок

- DataType <- Number, Varcher - типы данных, поддерживаемые БД  
- Table, TableField, TableRow - классы, задающие структуру таблицы  
- TableIO - обертка для низкоуровневого файлового IO  
- Engine - область имен, содержащая функции для работы с движком  
- EngineException, EngineStatusEnum - система исключений движка  

## Модуль 3 - Парсер запросов

- LexicParser - лексический парсер  
- QueryParser - синтаксический парсер запросов  
- QueryParserException, QueryStatusEnum - система исключений парсера  

## Модуль 4 - Исполнитель запросов

- condition_tree/* - классы для работы с деревом WHERE-клаузы  
- QueryObject <- SelectObject, InsertObject, ... - классы для внутреннего представления запроса  
- QueryResult <- SelectQueryResult, InsertQueryResult, ... - классы для представления результата выполнения запроса  

## Перед запуском

- В `src/engine/Config.h` поменять путь в распололожению БД `STORAGE_LOCATION` на свой  

## Компилирование

- Исполняемые файлы клиента/сервера - `make main`  
- Тесты - `make test`  
- Полное компилирование - `make`  

## Запуск

- Запуск сервера - `./out/main/server.out`  
- Запуск клиента - `./out/main/client.out`  

## Авторы

- Кислов Евгений  
- Зайденварг Елизавета  
